/*
 * main.c
 *
 *  Created on: Nov 17, 2017
 *      Author: root
 */


#include <stdio.h>
#include <stdlib.h>
#include <openssl/hmac.h>
#include <openssl/rand.h>

#include <libconfig.h>
#include "main.h"

#if 0
int main(void) {
	BIGNUM *x, *y, *mask;

    if (((mask = BN_new()) == NULL)) {
        puts("unable to commit to peer!\n");
        return -1;
    }
    else{
		puts("!!!Hello World!!!"); /* prints !!!Hello World!!! */
		return EXIT_SUCCESS;
    }
}
#else
int main(void) {
	char *conffile = "/work/C_Project/openssl_trial/authsae.sample.cfg";
    struct sae_config sae_conf;

    if (conffile) {
        struct config_t cfg;
        struct config_setting_t *section;

        config_init(&cfg);
        if (!config_read_file(&cfg, conffile)) {
            fprintf(stderr, "Failed to load config file %s: %s\n", conffile,
                    config_error_text(&cfg));
            return -1;
        }
        section = config_lookup(&cfg, "authsae.sae");
        if (section == NULL) {
            fprintf(stderr, "Config file has not sae section\n");
            return -1;
        }

        if (sae_parse_libconfig(section, &sae_conf) != 0) {
            fprintf(stderr, "Failed to parse SAE configuration.\n");
            return -1;
        }

        config_destroy(&cfg);
    }

	return EXIT_SUCCESS;
}
#endif
