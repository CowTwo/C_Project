/*
 * sae.h
 *
 *  Created on: Nov 18, 2017
 *      Author: root
 */

#ifndef MAIN_H_
#define MAIN_H_

#include <openssl/hmac.h>
#include <openssl/rand.h>
#include <openssl/ec.h>
#include <openssl/ossl_typ.h>
#include <openssl/sha.h>

#define    SAE_MAX_EC_GROUPS    10
#define    SAE_MAX_PASSWORD_LEN 80

struct sae_config {
    int group[SAE_MAX_EC_GROUPS];
    int num_groups;
    char pwd[SAE_MAX_PASSWORD_LEN];
    int debug;
    int retrans;
    int pmk_expiry;
    int open_threshold;
    int blacklist_timeout;
    int giveup_threshold;
};

#ifndef LIBCONFIG_SETTING_INT_AS_LONG
typedef int config_int_t;
#else
typedef long int config_int_t;
#endif

typedef struct group_def_ {
    unsigned short group_num;
    EC_GROUP *group;
    BIGNUM *order;
    BIGNUM *prime;
    char password[80];
    struct group_def_ *next;
} GD;


int
sae_parse_libconfig (struct config_setting_t *sae_section, struct sae_config* config);


#endif /* MAIN_H_ */
